<style>
@charset "UTF-8";
body {
  background-image: radial-gradient(ellipse at center, #a3dbfd 33%, #4fb3d5 100%);
  display: grid;
  margin: 0;
  min-height: 100vh;
  place-items: center;
  position: relative;
}

#canvas {
  display: block;
  position: absolute;
  z-index: 1;
}

#start {
  align-items: center;
  background-color: #000;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  height: 70px;
  justify-content: center;
  outline: 0;
  padding: 0;
  width: 70px;
  z-index: 2;
}
#start::before {
  border-bottom: 20px solid transparent;
  border-left: 25px solid #fff;
  border-top: 20px solid transparent;
  content: "";
  display: block;
  transform: translate(5px);
}
#start.playing {
  background-color: #feab12;
  cursor: default;
}
#start.playing::before {
  content: "üï∂Ô∏è";
  border: none;
  font-size: 80px;
  transform: translate(0, 0);
}


</style>

<canvas id="canvas"></canvas>
<div id="start"></div>

<script>
const canvas = document.getElementById("canvas");
const canvasCtx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let centerX = canvas.width / 2;
let centerY = canvas.height / 2;

const audio = new Audio();
const start = document.getElementById("start");

start.addEventListener("click", () => {
  if (!audio.paused) {
    return;
  }

  start.classList.add("playing");
  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  const analyser = audioCtx.createAnalyser();

  audio.src =
    "https://mojojohoe.github.io/Kinko/Public/WorldIsNotEnough.mp3";
  audio.crossOrigin = "anonymous";

  const source = audioCtx.createMediaElementSource(audio);
  source.connect(analyser);
  analyser.connect(audioCtx.destination);

  analyser.fftSize = 4096;
  const bufferLength = analyser.frequencyBinCount;
  const dataArray = new Uint8Array(bufferLength);

  const draw = () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    centerX = canvas.width / 2;
    centerY = canvas.height / 2;

    analyser.getByteTimeDomainData(dataArray);
    const lines = bufferLength / 1;

    for (var i = 0; i < lines; i++) {
      const height = dataArray[i] * 2;
      const radius = 10;
      const rads = Math.PI * 2 / lines;
      const x1 = centerX + radius * Math.cos(rads * i);
      const y1 = centerY + radius * Math.sin(rads * i);
      const x2 = centerX + (radius + height) * Math.cos(rads * i);
      const y2 = centerY + (radius + height) * Math.sin(rads * i);

      canvasCtx.moveTo(x1, y1);
      canvasCtx.lineTo(x2, y2);
    }

    canvasCtx.strokeStyle = "#feab12";
    canvasCtx.stroke();
    requestAnimationFrame(draw);
  };
  close;

  audio.play();
  draw();
});

audio.addEventListener("ended", () => {
  start.classList.remove("playing");
});

</script>